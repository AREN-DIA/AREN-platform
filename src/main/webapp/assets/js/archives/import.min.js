const Archive={clear(){this.Category=[];this.Document=[];this.Debate=[];this.Comment=[];this.Institution=[];this.Notification=[];this.Team=[];this.User=[]},get(b,a){if(this.hasOwnProperty(a.name)){let d=this[a.name].findIndex(a=>a.id===1*b);return-1===d?-1:this[a.name][d]}return-1},getOrCreate(b,a){let d=this.get(b.id||b.categoryId||b.documentId||b.debateId||b.annotationId||b.groupId||b.creationDate||!1,a);-1===d&&(d=this.convert[a.name](b),this[a.name].push(d));return d},convert:{Category:function(b){let a=
new Category;a.id=b.categoryId;a.name=b.name;a.picture=b.image;a.documentsCount=b.documentsCount;a.debatesCount=b.debatesCount;a.lastCommentDate=new Date(b.lastPostDate);a.documents=[];return a},Document:function(b){let a=new Document;a.id=b.documentId;a.created=new Date(b.creationDate);a.name=b.title;a.author=b.author;a.content=b.text;a.debatesCount=0;a.lastCommentDate=new Date(0);a.debates=[];return a},Debate:function(b){let a=new Debate;a.id=b.debateId;a.created=new Date(b.openDate);a.name=b.name;
a.closed=b.closedDate;a.active=!b.isClosed;a.commentsCount=0;a.commentsCountFor=0;a.commentsCountAgainst=0;a.lastCommentDate=new Date(b.lastPostDate);a.guests=[];a.owner=new User;a.document=Archive.getOrCreate(b.document,Document);a.document.debates.includes(a)||a.document.debates.push(a);a.document.category=Archive.getOrCreate(b.categoriesList[0],Category);a.document.category.documents.includes(a.document)||a.document.category.documents.push(a.document);let d=b.groupsList.length;for(var e=0;e<d;e++){var c=
Archive.getOrCreate(b.groupsList[e],Team);a.teams.includes(c)||a.teams.push(c);c.debates.includes(a)||c.debates.push(a)}d=b.annotationsList[0].childrenAnnotationsList.length;for(e=0;e<d;e++)c=Archive.getOrCreate(b.annotationsList[0].childrenAnnotationsList[e],Comment),c.startContainer=c.startContainer.split("/"),--c.startContainer[0],c.startContainer=c.startContainer.join("/"),c.endContainer=c.endContainer.split("/"),--c.endContainer[0],c.endContainer=c.endContainer.join("/"),a.comments.includes(c)||
a.comments.push(c);a.comments.forEach(function f(b){a.comments.includes(b)||a.comments.push(b);a.commentsCount++;a.commentsCountFor+="FOR"===b.opinion?1:0;a.commentsCountAgainst+="AGAINST"===b.opinion?1:0;b.debate=a;b.comments.forEach(f)});return a},Comment:function(b){let a=new Comment;a.id=b.annotationId;a.created=new Date(b.creationDate);a.reformulation=b.reformulation;a.argumentation=b.argumentation;a.selection=b.annotationText;a.tags=[];var d=b.annotationStart.split("/").reverse().map((a,b)=>
a*Math.pow(10,5*(b+1))).reduce((a,b)=>a+b)+b.annotationStartOffset,e=b.annotationEnd.split("/").reverse().map((a,b)=>a*Math.pow(10,5*(b+1))).reduce((a,b)=>a+b)+b.annotationEndOffset;d<e?(a.startContainer=b.annotationStart,a.startOffset=b.annotationStartOffset,a.endContainer=b.annotationEnd,a.endOffset=b.annotationEndOffset):(a.startContainer=b.annotationEnd,a.startOffset=b.annotationEndOffset,a.endContainer=b.annotationStart,a.endOffset=b.annotationStartOffset);a.opinion=1===b.adviseGrade?Opinion.AGAINST:
2===b.adviseGrade?Opinion.FOR:Opinion.NEUTRAL;a.signaled=!1;a.moderated=!1;a.owner=Archive.getOrCreate(b.user,User);a.owner.comments.includes(a)||a.owner.comments.push(a);d=b.childrenAnnotationsList.length;for(e=0;e<d;e++){let c=Archive.getOrCreate(b.childrenAnnotationsList[e],Comment);a.comments.includes(c)||a.comments.push(c);c.parent=a}return a},Team:function(b){let a=new Team;a.id=b.groupId;a.entId=b.entId;a.name=b.name;a.community=!1;a.debatesCount=b.openDebatesCount;a.usersCount=0;a.users=[];
return a},User:function(b){let a=new User;a.id=b.creationDate;a.entId=b.entId;a.username=b.username;a.firstName=b.firstName;a.lastName=b.lastName;a.email=b.email;a.lastLogin=b.lastLoginDate;a.active=!0;a.authority=1===b.roleGrade?Authority.MODO:0===b.roleGrade?Authority.ADMIN:Authority.USER;return a}},importation(b){let a=[];Archive.clear();"2.json 3.json 4.json 7.json 8.json 9.json 10.json 11.json 12.json 13.json 14.json 15.json".split(" ").forEach(function(b,e){a.push(fetch("assets/js/archives/"+
b).then(function(a){return a.ok?a.json():!1}).then(function(a){if(a){let b=a.length;for(let c=0;c<b;c++)Archive.getOrCreate(a[c],Debate)}}))});Promise.all(a).then(function(){b&&b()})}};Archive.clear();